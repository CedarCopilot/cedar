---
title: 'Agent Input Context'
description: 'Provide additional context to your AI agents'
---

# Agent Input Context

Agent Input Context allows you to provide additional information to your AI agents beyond just the user's message. This includes application state, user data, conversation history, and any other contextual information that helps the agent provide better responses.

## How It Works

When a user sends a message, Cedar automatically gathers context from various sources:

1. **Registered State**: Application state you've made available to the agent
2. **Mentions**: Specific data the user has referenced with @ mentions
3. **Conversation History**: Previous messages in the chat
4. **Custom Context**: Any additional data you provide

## Basic Usage

Enable context gathering in your chat components:

```tsx
import { ChatInput } from 'cedar-os';

function ContextAwareChat() {
	return (
		<ChatInput
			enableContext={true}
			contextSources={['state', 'mentions', 'history']}
			maxContextLength={5000} // Limit context size
		/>
	);
}
```

## Context Sources

### Automatic Context

Cedar automatically includes:

- **User Message**: The current message being sent
- **Chat History**: Recent conversation messages
- **System State**: Basic application information

### Custom Context

Add your own context providers:

```tsx
import { useCedarStore } from 'cedar-os';

function MyComponent() {
	const { setContextProvider } = useCedarStore();

	useEffect(() => {
		setContextProvider('user-profile', () => ({
			userId: user.id,
			preferences: user.preferences,
			subscription: user.subscriptionTier,
		}));

		setContextProvider('app-state', () => ({
			currentPage: window.location.pathname,
			userActions: getRecentActions(),
			environmentInfo: getEnvironmentData(),
		}));
	}, [user]);

	return <ChatInput enableContext={true} />;
}
```

## Context Formatting

Control how context is formatted for the AI:

```tsx
<ChatInput
	contextFormatter={{
		includeTimestamps: true,
		maxHistoryMessages: 10,
		summarizeOldMessages: true,
		formatters: {
			'user-profile': (data) => `User: ${data.userId} (${data.subscription})`,
			'app-state': (data) => `Current page: ${data.currentPage}`,
		},
	}}
/>
```

## Context Visibility

Show users what context is being sent:

```tsx
function TransparentChat() {
	const [showContext, setShowContext] = useState(false);

	return (
		<div>
			<button
				onClick={() => setShowContext(!showContext)}
				className='text-sm text-gray-600 mb-2'>
				{showContext ? 'Hide' : 'Show'} Context
			</button>

			<ChatInput
				enableContext={true}
				showContextPreview={showContext}
				onContextGenerated={(context) => {
					console.log('Generated context:', context);
				}}
			/>
		</div>
	);
}
```

## Context Optimization

Optimize context for better performance and relevance:

```tsx
const contextConfig = {
	// Prioritize recent and relevant information
	prioritization: {
		recentMessages: 1.0,
		mentionedState: 0.9,
		userProfile: 0.7,
		appState: 0.5,
	},

	// Compress context when it gets too large
	compression: {
		enabled: true,
		maxTokens: 3000,
		strategy: 'summarize', // or 'truncate'
	},

	// Cache context for performance
	caching: {
		enabled: true,
		ttl: 60000, // 1 minute
		keyGenerator: (sources) => `context-${sources.join('-')}`,
	},
};

<ChatInput contextConfig={contextConfig} />;
```

## Advanced Context Patterns

### Conditional Context

Include context based on conditions:

```tsx
const contextProviders = {
	'error-logs': () => {
		// Only include error logs if user is asking about issues
		const lastMessage = getLastUserMessage();
		if (lastMessage.includes('error') || lastMessage.includes('bug')) {
			return getRecentErrorLogs();
		}
		return null;
	},

	'user-data': () => {
		// Only include sensitive data if user is authenticated
		if (user.isAuthenticated) {
			return getUserPersonalData();
		}
		return { status: 'guest' };
	},
};
```

### Context Middleware

Process context before sending to AI:

```tsx
const contextMiddleware = [
	// Remove sensitive information
	(context) => {
		return {
			...context,
			userProfile: {
				...context.userProfile,
				password: undefined,
				ssn: undefined,
			},
		};
	},

	// Add computed fields
	(context) => {
		return {
			...context,
			computed: {
				userTier: calculateUserTier(context.userProfile),
				riskLevel: assessRiskLevel(context.appState),
			},
		};
	},
];

<ChatInput contextMiddleware={contextMiddleware} />;
```

## Next Steps

- Learn about [subscribing to state](/getting-started/chat/subscribing-state)
- Explore [mentions functionality](/getting-started/chat/mentions)
